make this elegant, modern with beautiful comments and more organised. But don't change the logic, nothing is allowed to change visually.
